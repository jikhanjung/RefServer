# RefServer API í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ (v0.1.7)

RefServer APIì˜ ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ê²€ì¦í•˜ëŠ” ì¢…í•© ê°€ì´ë“œì…ë‹ˆë‹¤.
**í™˜ê²½ ì ì‘í˜• í…ŒìŠ¤íŠ¸ + ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œìŠ¤í…œ** - GPU/CPU í™˜ê²½ ìë™ ê°ì§€ + ìƒˆë¡œìš´ ì—…ë¡œë“œ/í´ë§ ì›Œí¬í”Œë¡œìš° ì§€ì›

## ğŸ“‹ ëª©ì°¨

- [ê°œìš”](#ê°œìš”)
- [í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì¹˜](#í…ŒìŠ¤íŠ¸-ìŠ¤í¬ë¦½íŠ¸-ì„¤ì¹˜)
- [ê¸°ë³¸ ì‚¬ìš©ë²•](#ê¸°ë³¸-ì‚¬ìš©ë²•)
- [ê³ ê¸‰ ì‚¬ìš©ë²•](#ê³ ê¸‰-ì‚¬ìš©ë²•)
- [í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤](#í…ŒìŠ¤íŠ¸-ì‹œë‚˜ë¦¬ì˜¤)
- [ì˜ˆìƒ ê²°ê³¼](#ì˜ˆìƒ-ê²°ê³¼)
- [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ê°œìš”

`test_api.py`ëŠ” RefServerì˜ ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì²´ê³„ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ìë™í™” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

### ğŸ¯ í…ŒìŠ¤íŠ¸ ë²”ìœ„
- **27ê°œ API ì—”ë“œí¬ì¸íŠ¸** ì „ì²´ í…ŒìŠ¤íŠ¸ (ë¹„ë™ê¸° ì²˜ë¦¬ + ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤ í¬í•¨)
- **ë¹„ë™ê¸° PDF ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš°** - ì—…ë¡œë“œ ì¦‰ì‹œ ì‘ë‹µ + ì‹¤ì‹œê°„ ìƒíƒœ ì¶”ì 
- **ë ˆê±°ì‹œ ë™ê¸° ì²˜ë¦¬** - í•˜ìœ„ í˜¸í™˜ì„± ê²€ì¦
- **ì„œë¹„ìŠ¤ ìƒíƒœ** ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- **ì˜¤ë¥˜ ì²˜ë¦¬** ë° ì˜ˆì™¸ ìƒí™© ê²€ì¦ (job ìƒíƒœ, ì—…ë¡œë“œ ì˜¤ë¥˜ í¬í•¨)
- **ì„±ëŠ¥ ì¸¡ì •** ë° ì‘ë‹µ ì‹œê°„ ë¶„ì„

### âœ… í…ŒìŠ¤íŠ¸ë˜ëŠ” ì—”ë“œí¬ì¸íŠ¸

#### ğŸ”„ ë¹„ë™ê¸° ì²˜ë¦¬ API (NEW in v0.1.6)
1. `POST /upload` - PDF ì—…ë¡œë“œ (ì¦‰ì‹œ job_id ë°˜í™˜)
2. `GET /job/{job_id}` - ì²˜ë¦¬ ìƒíƒœ ë° ì§„í–‰ë¥  ì‹¤ì‹œê°„ ì¡°íšŒ

#### ğŸ“„ í•µì‹¬ API ì—”ë“œí¬ì¸íŠ¸
3. `GET /health` - í—¬ìŠ¤ì²´í¬
4. `GET /status` - ì„œë¹„ìŠ¤ ìƒíƒœ
5. `POST /process` - PDF ì²˜ë¦¬ (ë ˆê±°ì‹œ, deprecated)
6. `GET /paper/{doc_id}` - ë…¼ë¬¸ ì •ë³´
7. `GET /metadata/{doc_id}` - ì„œì§€ì •ë³´
8. `GET /embedding/{doc_id}` - ë²¡í„° ì„ë² ë”©
9. `GET /layout/{doc_id}` - ë ˆì´ì•„ì›ƒ ë¶„ì„
10. `GET /preview/{doc_id}` - ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€
11. `GET /text/{doc_id}` - í…ìŠ¤íŠ¸ ë‚´ìš©
12. `GET /search` - ë…¼ë¬¸ ê²€ìƒ‰
13. `GET /stats` - ì‹œìŠ¤í…œ í†µê³„

#### âš ï¸ ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
14. **Invalid endpoints** - 404 ì˜¤ë¥˜ (job, paper, metadata ë“±)
15. **Upload errors** - íŒŒì¼ ì—†ìŒ, ì˜ëª»ëœ íŒŒì¼ íƒ€ì… ë“±

---

## í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì¹˜

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
# í…ŒìŠ¤íŠ¸ ì „ìš© ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements-test.txt

# ë˜ëŠ” ê°œë³„ ì„¤ì¹˜
pip install requests reportlab
```

### 2. ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
```bash
chmod +x test_api.py
```

### 3. RefServer ì‹¤í–‰ í™•ì¸
```bash
# Docker Composeë¡œ RefServer ì‹¤í–‰
docker-compose up -d

# ì„œë²„ ìƒíƒœ í™•ì¸ (ìˆ˜ë™)
curl http://localhost:8060/health
```

---

## ê¸°ë³¸ ì‚¬ìš©ë²•

### ğŸš€ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
```bash
# ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (localhost:8060)
python test_api.py
```

### ğŸ“Š ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
[12:34:56] INFO: ğŸš€ Starting RefServer API Tests
[12:34:56] INFO: ==================================================
[12:34:56] INFO: Testing health check endpoint...
[12:34:56] PASS: âœ… Health Check - PASSED (200)
[12:34:56] INFO:    Service status: healthy

[12:34:57] INFO: Testing service status endpoint...
[12:34:57] PASS: âœ… Service Status - PASSED (200)
[12:34:57] INFO:    Database: âœ…
[12:34:57] INFO:    Quality Assessment (GPU): âœ…  
[12:34:57] INFO:    Layout Analysis (GPU): âœ…
[12:34:57] INFO:    Metadata Extraction (CPU): âœ…
[12:34:57] INFO:    ğŸ® GPU Mode: All services available

[12:34:58] INFO: 

[12:34:58] INFO: ğŸ“¤ Testing Async PDF Processing Workflow
[12:34:58] INFO: Testing PDF upload endpoint...
[12:34:58] INFO:    Created test PDF: /tmp/test_paper.pdf
[12:34:58] INFO:    Uploading PDF: test_paper.pdf
[12:34:59] PASS: âœ… PDF Upload - PASSED (200)
[12:34:59] INFO:    Job ID: abc-123-def-456
[12:34:59] INFO:    Status: uploaded
[12:34:59] INFO:    Upload time: 0.85s
[12:34:59] INFO:    Message: PDF uploaded successfully

[12:34:59] INFO: Testing job status polling for job: abc-123-def-456
[12:35:01] PASS: âœ… Job Status - PASSED (200)
[12:35:01] INFO:    Progress: 20% - ocr_processing
[12:35:03] PASS: âœ… Job Status - PASSED (200)
[12:35:03] INFO:    Progress: 45% - quality_assessment
[12:35:05] PASS: âœ… Job Status - PASSED (200)
[12:35:05] INFO:    Progress: 67% - embedding_generation
[12:35:07] PASS: âœ… Job Status - PASSED (200)
[12:35:07] INFO:    Progress: 85% - layout_analysis
[12:35:09] PASS: âœ… Job Status - PASSED (200)
[12:35:09] INFO:    âœ… Processing completed in 10.23s
[12:35:09] INFO:    Document ID: 550e8400-e29b-41d4-a716-446655440000

[12:35:10] INFO: 

[12:35:10] INFO: ğŸ”„ Testing Legacy Synchronous Processing
[12:35:42] INFO:    Success: True
[12:35:42] INFO:    Processing time: 45.23s
[12:35:42] INFO:    Steps completed: 6
[12:35:42] INFO:    Steps failed: 0
[12:35:42] INFO:    Using doc_id 550e8400-e29b-41d4-a716-446655440000 for subsequent tests

[12:35:43] INFO: Testing paper info endpoint...
[12:35:43] PASS: âœ… Paper Info - PASSED (200)
[12:35:43] INFO:    Filename: test.pdf
[12:35:43] INFO:    OCR Quality: good|score:75|confidence:85
[12:35:43] INFO:    Text length: 156

[12:35:44] INFO: Testing metadata endpoint...
[12:35:44] PASS: âœ… Metadata - PASSED (200)
[12:35:44] INFO:    Title: Test Academic Paper
[12:35:44] INFO:    Authors: 2 found
[12:35:44] INFO:    Year: 2024
[12:35:44] INFO:    Journal: Test Journal of Computer Science

[12:36:15] INFO: ==================================================
[12:36:15] INFO: ğŸ“Š Test Summary
[12:36:15] INFO:    Total tests: 12
[12:36:15] INFO:    Passed: 11 âœ…
[12:36:15] INFO:    Failed: 1 âŒ
[12:36:15] INFO:    Success rate: 91.7%
[12:36:15] INFO:    Total time: 78.45s
[12:36:15] INFO:    Test document ID: 550e8400-e29b-41d4-a716-446655440000
```

---

## ê³ ê¸‰ ì‚¬ìš©ë²•

### ğŸ”§ ì»¤ìŠ¤í…€ ì„œë²„ URL
```bash
# ë‹¤ë¥¸ ì„œë²„ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ RefServer í…ŒìŠ¤íŠ¸
python test_api.py --url http://192.168.1.100:8060

# í¬íŠ¸ê°€ ë‹¤ë¥¸ ê²½ìš°
python test_api.py --url http://localhost:9000
```

### ğŸ“„ íŠ¹ì • PDF íŒŒì¼ ì‚¬ìš©
```bash
# ì‹¤ì œ í•™ìˆ  ë…¼ë¬¸ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
python test_api.py --pdf /path/to/research_paper.pdf

# ë³µì¡í•œ PDFë¡œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
python test_api.py --pdf /path/to/complex_document.pdf
```

### â±ï¸ íƒ€ì„ì•„ì›ƒ ì„¤ì •
```bash
# í° PDF íŒŒì¼ì„ ìœ„í•œ ê¸´ íƒ€ì„ì•„ì›ƒ (120ì´ˆ)
python test_api.py --timeout 120

# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì§§ì€ íƒ€ì„ì•„ì›ƒ (10ì´ˆ)
python test_api.py --timeout 10
```

### ğŸ”„ ì¡°í•© ì‚¬ìš© ì˜ˆì‹œ
```bash
# ì›ê²© ì„œë²„ì˜ ì‹¤ì œ PDFë¡œ ì¢…í•© í…ŒìŠ¤íŠ¸
python test_api.py \
  --url http://production-server:8060 \
  --pdf /data/papers/nature_2024.pdf \
  --timeout 180
```

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 1: GPU í™˜ê²½ ì „ì²´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
**ëª©ì **: GPU ê°€ì† ê¸°ëŠ¥ì„ í¬í•¨í•œ ëª¨ë“  ê¸°ëŠ¥ ê²€ì¦
```bash
# GPU í™˜ê²½ì—ì„œ ì‹¤í–‰ (docker-compose.yml)
python test_api.py
```
**ê²€ì¦ í•­ëª©**:
- **ğŸ® GPU ê¸°ëŠ¥**: LLaVA í’ˆì§ˆ í‰ê°€, Huridocs ë ˆì´ì•„ì›ƒ ë¶„ì„
- **ë¹„ë™ê¸° ì—…ë¡œë“œ**: ì¦‰ì‹œ job_id ë°˜í™˜ (< 1ì´ˆ)
- **ì‹¤ì‹œê°„ ìƒíƒœ ì¶”ì **: 2ì´ˆ ê°„ê²© í´ë§ìœ¼ë¡œ ì§„í–‰ë¥  í™•ì¸
- **LLM ê¸°ë°˜ ë©”íƒ€ë°ì´í„°**: ê³ í’ˆì§ˆ ì„œì§€ì •ë³´ ì¶”ì¶œ
- **ì™„ì „í•œ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**: 7ë‹¨ê³„ ëª¨ë“  ì²˜ë¦¬ ìˆ˜í–‰
- ì „ì²´ API ì—”ë“œí¬ì¸íŠ¸ ì •ìƒ ë™ì‘ (17ê°œ í…ŒìŠ¤íŠ¸)

**ì˜ˆìƒ ê²°ê³¼**: 90-100% ì„±ê³µë¥ 

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 2: CPU í™˜ê²½ í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
**ëª©ì **: GPU ì—†ëŠ” í™˜ê²½ì—ì„œ í•µì‹¬ ê¸°ëŠ¥ ê²€ì¦
```bash
# CPU í™˜ê²½ì—ì„œ ì‹¤í–‰ (docker-compose.cpu.yml)
python test_api.py
```
**ê²€ì¦ í•­ëª©**:
- **ğŸ–¥ï¸ CPU ê¸°ëŠ¥**: OCR, ì„ë² ë”©, rule-based ë©”íƒ€ë°ì´í„°
- **ë¹„ë™ê¸° ì—…ë¡œë“œ**: GPUì™€ ë™ì¼í•œ ì—…ë¡œë“œ ì„±ëŠ¥
- **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: CPU ê¸°ë°˜ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- **Fallback ì²˜ë¦¬**: GPU ê¸°ëŠ¥ ëŒ€ì‹  ëŒ€ì²´ ì²˜ë¦¬ ìˆ˜í–‰
- **í•µì‹¬ API**: ì—…ë¡œë“œ, ìƒíƒœ ì¶”ì , í…ìŠ¤íŠ¸/ì„ë² ë”© ì¡°íšŒ

**ì˜ˆìƒ ê²°ê³¼**: 70-85% ì„±ê³µë¥  (GPU ê¸°ëŠ¥ ì œì™¸)

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 3: ì‹¤ì œ ë…¼ë¬¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
**ëª©ì **: ì‹¤ì œ í•™ìˆ  ë…¼ë¬¸ ì²˜ë¦¬ ì„±ëŠ¥ í™•ì¸
```bash
python test_api.py --pdf /path/to/real_paper.pdf
```
**ê²€ì¦ í•­ëª©**:
- ë³µì¡í•œ PDF ì²˜ë¦¬ ëŠ¥ë ¥
- OCR í’ˆì§ˆ
- ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ì •í™•ë„
- ë ˆì´ì•„ì›ƒ ë¶„ì„ ì„±ëŠ¥

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 4: ì„œë¹„ìŠ¤ ë¶€ë¶„ ì¥ì•  ì‹œë®¬ë ˆì´ì…˜
**ëª©ì **: ì™¸ë¶€ ì„œë¹„ìŠ¤ ì¥ì•  ì‹œ ë™ì‘ í™•ì¸
```bash
# Ollama ì„œë¹„ìŠ¤ë¥¼ ì¤‘ë‹¨í•œ ìƒíƒœì—ì„œ í…ŒìŠ¤íŠ¸
python test_api.py
```
**ê²€ì¦ í•­ëª©**:
- ê¸°ë³¸ OCR ê¸°ëŠ¥ ìœ ì§€
- ì ì ˆí•œ ì˜¤ë¥˜ ë©”ì‹œì§€
- ë¶€ë¶„ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 5: ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
**ëª©ì **: ë¹„ë™ê¸° ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ ë° ë‹¤ì¤‘ ì²˜ë¦¬ ëŠ¥ë ¥ í™•ì¸
```bash
# í° PDF íŒŒì¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
python test_api.py --pdf large_document.pdf --timeout 300
```
**ê²€ì¦ í•­ëª©**:
- **ì—…ë¡œë“œ ì‘ë‹µ ì‹œê°„**: íŒŒì¼ í¬ê¸°ì™€ ë¬´ê´€í•˜ê²Œ ì¦‰ì‹œ ì‘ë‹µ
- **ì²˜ë¦¬ ì§„í–‰ë¥  ì •í™•ì„±**: ì‹¤ì œ ì²˜ë¦¬ ë‹¨ê³„ì™€ progress % ì¼ì¹˜
- **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ì‹œê°„**: ì „ì²´ íŒŒì´í”„ë¼ì¸ ì²˜ë¦¬ ì‹œê°„ ì¸¡ì •
- **ì˜¤ë¥˜ ë³µêµ¬**: ì²˜ë¦¬ ì¤‘ ì‹¤íŒ¨ ì‹œ ì ì ˆí•œ ì˜¤ë¥˜ ìƒíƒœ ë°˜í™˜

### ğŸ§ª ì‹œë‚˜ë¦¬ì˜¤ 6: ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì˜ˆì™¸ ìƒí™©
**ëª©ì **: ë‹¤ì–‘í•œ ì˜¤ë¥˜ ìƒí™©ì—ì„œì˜ ì‹œìŠ¤í…œ ì•ˆì •ì„± í™•ì¸
```bash
python test_api.py
```
**ê²€ì¦ í•­ëª©**:
- **ì˜ëª»ëœ job_id ì¡°íšŒ**: 404 ì˜¤ë¥˜ ì ì ˆíˆ ë°˜í™˜
- **íŒŒì¼ ì—†ëŠ” ì—…ë¡œë“œ**: 422 validation ì˜¤ë¥˜
- **ë¹„PDF íŒŒì¼ ì—…ë¡œë“œ**: íŒŒì¼ íƒ€ì… ê²€ì¦
- **íƒ€ì„ì•„ì›ƒ ìƒí™©**: ì¥ì‹œê°„ ì²˜ë¦¬ ì¤‘ ìƒíƒœ ì¶”ì 

---

## ì˜ˆìƒ ê²°ê³¼

### âœ… ì •ìƒ ë™ì‘ ì‹œë‚˜ë¦¬ì˜¤

#### ğŸ® GPU í™˜ê²½ - ëª¨ë“  ì„œë¹„ìŠ¤ ì •ìƒ (ìµœì  ìƒíƒœ)
```
ğŸ“Š Test Summary
   Total tests: 17
   Passed: 17 âœ…
   Failed: 0 âŒ
   Success rate: 100.0%
   Total time: 45.23s
   Deployment mode: GPU
   ğŸ® GPU Features: Quality assessment âœ…, Layout analysis âœ…, LLM metadata âœ…
   ğŸ‰ Test PASSED for GPU mode
```
**íŠ¹ì§•**: ëª¨ë“  GPU ê°€ì† ê¸°ëŠ¥ + ë¹„ë™ê¸° ì²˜ë¦¬ ì™„ë²½ ë™ì‘

#### ğŸ–¥ï¸ CPU í™˜ê²½ - í•µì‹¬ ê¸°ëŠ¥ ì •ìƒ (ì˜ˆìƒ ë™ì‘)
```
ğŸ“Š Test Summary
   Total tests: 17
   Passed: 13 âœ…     # í•µì‹¬ ê¸°ëŠ¥ ì •ìƒ
   Failed: 4 âŒ      # GPU ì „ìš© ê¸°ëŠ¥ ì œì™¸
   Success rate: 76.5%
   Total time: 35.12s    # fallback ì²˜ë¦¬ë¡œ ë¹ ë¥¸ ì™„ë£Œ
   Deployment mode: CPU
   ğŸ–¥ï¸ CPU Features: Core processing âœ…, Rule-based metadata âœ…
   âš ï¸ GPU Features: Quality assessment âŒ, Layout analysis âŒ
   ğŸ‰ Test PASSED for CPU mode
```
**íŠ¹ì§•**: ë¹„ë™ê¸° ì—…ë¡œë“œ ì •ìƒ, GPU ê¸°ëŠ¥ ëŒ€ì‹  fallback ì²˜ë¦¬ ìˆ˜í–‰

#### âš ï¸ ë¶€ë¶„ ì¥ì•  - ì™¸ë¶€ ì„œë¹„ìŠ¤ ì¼ë¶€ ì‹¤íŒ¨
```
ğŸ“Š Test Summary
   Total tests: 17
   Passed: 11 âœ…     # ê¸°ë³¸ ê¸°ëŠ¥ë§Œ ë™ì‘
   Failed: 6 âŒ      # ì™¸ë¶€ ì„œë¹„ìŠ¤ ì˜ì¡´ ê¸°ëŠ¥ ì‹¤íŒ¨
   Success rate: 64.7%
   Total time: 25.15s    # ë¹ ë¥¸ ì‹¤íŒ¨ë¡œ ë” ë¹ ë¥¸ ì™„ë£Œ
```
**íŠ¹ì§•**: OCR, ì„ë² ë”© ë“± í•µì‹¬ ê¸°ëŠ¥ì€ ì •ìƒ, LLM/GPU ì„œë¹„ìŠ¤ ì¥ì• 

### ğŸ” í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„

#### í™˜ê²½ë³„ ì„±ê³µë¥  í•´ì„ ê¸°ì¤€

##### ğŸ® GPU í™˜ê²½ ê¸°ì¤€
- **90-100%**: ğŸŸ¢ ìš°ìˆ˜ - ëª¨ë“  GPU ê¸°ëŠ¥ + ë¹„ë™ê¸° ì²˜ë¦¬ ì •ìƒ
- **80-89%**: ğŸŸ¡ ì–‘í˜¸ - í•µì‹¬ ê¸°ëŠ¥ ì •ìƒ, ì¼ë¶€ GPU ê¸°ëŠ¥ ì œí•œ
- **70-79%**: ğŸŸ  ì£¼ì˜ - ê¸°ë³¸ ì²˜ë¦¬ëŠ” ê°€ëŠ¥í•˜ë‚˜ GPU ì„œë¹„ìŠ¤ ì ê²€ í•„ìš”
- **70% ë¯¸ë§Œ**: ğŸ”´ ë¬¸ì œ - ì‹œìŠ¤í…œ ì „ì²´ ì ê²€ í•„ìš”

##### ğŸ–¥ï¸ CPU í™˜ê²½ ê¸°ì¤€
- **70-85%**: ğŸŸ¢ ìš°ìˆ˜ - CPU ëª¨ë“œ ì •ìƒ ë™ì‘ (GPU ê¸°ëŠ¥ ì œì™¸ëŠ” ì •ìƒ)
- **60-69%**: ğŸŸ¡ ì–‘í˜¸ - í•µì‹¬ ê¸°ëŠ¥ ë™ì‘, ì¼ë¶€ ì„œë¹„ìŠ¤ ì œí•œ
- **50-59%**: ğŸŸ  ì£¼ì˜ - ê¸°ë³¸ ì²˜ë¦¬ë§Œ ê°€ëŠ¥, ì™¸ë¶€ ì„œë¹„ìŠ¤ ì ê²€ í•„ìš”
- **50% ë¯¸ë§Œ**: ğŸ”´ ë¬¸ì œ - í•µì‹¬ ì‹œìŠ¤í…œ ì ê²€ í•„ìš”

##### ğŸ“Š ê¸°ëŠ¥ë³„ ì„±ê³µë¥  ë¶„ì„
| ê¸°ëŠ¥ | GPU í™˜ê²½ | CPU í™˜ê²½ | ìµœì†Œ í™˜ê²½ |
|------|---------|---------|-----------|
| **ë¹„ë™ê¸° ì—…ë¡œë“œ** | âœ… | âœ… | âœ… |
| **OCR & ì„ë² ë”©** | âœ… | âœ… | âœ… |
| **í’ˆì§ˆ í‰ê°€** | âœ… | âŒ | âŒ |
| **ë ˆì´ì•„ì›ƒ ë¶„ì„** | âœ… | âŒ | âŒ |
| **LLM ë©”íƒ€ë°ì´í„°** | âœ… | âš ï¸ | âŒ |
| **Rule-based ë©”íƒ€ë°ì´í„°** | âœ… | âœ… | âœ… |

#### ì²˜ë¦¬ ì‹œê°„ ê¸°ì¤€
- **< 60ì´ˆ**: ğŸŸ¢ ë¹ ë¦„ - ìµœì  ì„±ëŠ¥
- **60-120ì´ˆ**: ğŸŸ¡ ë³´í†µ - ì •ìƒ ë²”ìœ„
- **120-300ì´ˆ**: ğŸŸ  ëŠë¦¼ - ì„±ëŠ¥ ìµœì í™” ê³ ë ¤
- **> 300ì´ˆ**: ğŸ”´ ë§¤ìš° ëŠë¦¼ - ì‹œìŠ¤í…œ ì ê²€ í•„ìš”

### ğŸ“‹ ìƒì„¸ ê²°ê³¼ ì˜ˆì‹œ

#### PDF ì²˜ë¦¬ ê²°ê³¼ ë¶„ì„
```json
{
  "doc_id": "550e8400-e29b-41d4-a716-446655440000",
  "success": true,
  "processing_time": 45.23,
  "steps_completed": ["save_paper", "ocr", "embedding", "layout"],
  "steps_failed": ["quality_assessment", "metadata"],
  "warnings": [
    "Quality assessment service unavailable",
    "Metadata extraction service unavailable"
  ],
  "data": {
    "ocr": {
      "text_length": 15420,
      "language": "en",
      "page_count": 8,
      "ocr_performed": true
    },
    "embedding": {
      "dimension": 1024,
      "content_id": "a7b9c3d2e1f4..."
    },
    "layout": {
      "page_count": 8,
      "total_elements": 245,
      "element_types": {
        "text": 189,
        "figure": 4,
        "table": 2
      }
    }
  }
}
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ ë° í•´ê²°ì±…

#### 1. ì—°ê²° ì˜¤ë¥˜
```
âŒ Cannot connect to http://localhost:8060
   Make sure RefServer is running with: docker-compose up
```
**í•´ê²°ì±…**:
```bash
# RefServer ì‹¤í–‰ ìƒíƒœ í™•ì¸
docker-compose ps

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose down && docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs refserver
```

#### 2. PDF ì²˜ë¦¬ íƒ€ì„ì•„ì›ƒ
```
âŒ PDF processing timed out (5 minutes)
```
**í•´ê²°ì±…**:
```bash
# íƒ€ì„ì•„ì›ƒ ëŠ˜ë¦¬ê¸°
python test_api.py --timeout 300

# ë” ì‘ì€ PDFë¡œ í…ŒìŠ¤íŠ¸
python test_api.py --pdf small_document.pdf
```

#### 3. ì™¸ë¶€ ì„œë¹„ìŠ¤ ì˜¤ë¥˜
```
âŒ Quality Assessment: Unavailable
âŒ Metadata Extraction: Unavailable
```
**í•´ê²°ì±…**:
```bash
# Ollama ì„œë¹„ìŠ¤ í™•ì¸
ollama list
ollama run llava
ollama run llama3.2

# ì„œë¹„ìŠ¤ ìƒíƒœ ì§ì ‘ í™•ì¸
curl http://localhost:11434/api/tags
```

#### 4. ë©”ëª¨ë¦¬ ë¶€ì¡±
```
âŒ BGE-M3 model loading failed: Out of memory
```
**í•´ê²°ì±…**:
```bash
# Docker ë©”ëª¨ë¦¬ í•œê³„ ì¦ê°€
# docker-compose.ymlì—ì„œ ë©”ëª¨ë¦¬ ì„¤ì • ì¡°ì •

# ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ í™•ì¸
free -h
docker stats
```

### ğŸ”§ ë””ë²„ê¹… íŒ

#### ìƒì„¸ ë¡œê·¸ í™•ì¸
```bash
# RefServer ë¡œê·¸ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
docker-compose logs -f refserver

# íŠ¹ì • ì‹œê°„ ë²”ìœ„ ë¡œê·¸
docker-compose logs --since="10m" refserver
```

#### ê°œë³„ API í…ŒìŠ¤íŠ¸
```bash
# í—¬ìŠ¤ì²´í¬ë§Œ í…ŒìŠ¤íŠ¸
curl http://localhost:8060/health

# ì„œë¹„ìŠ¤ ìƒíƒœë§Œ í™•ì¸
curl http://localhost:8060/status

# ìˆ˜ë™ PDF ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸
curl -X POST "http://localhost:8060/process" \
  -F "file=@test.pdf"
```

#### ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ì§„ë‹¨
```bash
# í¬íŠ¸ ì‚¬ìš© ìƒíƒœ í™•ì¸
netstat -tlnp | grep 8060

# Docker ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect refserver_default
```

### ğŸ“ ì§€ì› ë° ë³´ê³ 

í…ŒìŠ¤íŠ¸ ê´€ë ¨ ë¬¸ì œê°€ ì§€ì†ë˜ë©´:

1. **ë¡œê·¸ ìˆ˜ì§‘**: `docker-compose logs refserver > refserver.log`
2. **ì‹œìŠ¤í…œ ì •ë³´**: `docker-compose ps`, `docker stats`
3. **í…ŒìŠ¤íŠ¸ ê²°ê³¼**: `test_api.py` ì „ì²´ ì¶œë ¥
4. **í™˜ê²½ ì •ë³´**: OS, Docker ë²„ì „, ë©”ëª¨ë¦¬ ìš©ëŸ‰

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ

### ğŸš€ ì²˜ë¦¬ ì†ë„ ê°œì„  (ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œìŠ¤í…œ)
1. **ì—…ë¡œë“œ ìµœì í™”**: 
   - **ì¦‰ì‹œ ì‘ë‹µ**: íŒŒì¼ í¬ê¸°ì™€ ë¬´ê´€í•˜ê²Œ < 1ì´ˆ ì—…ë¡œë“œ ì™„ë£Œ
   - **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: CPU ì§‘ì•½ì  ì‘ì—…ì„ ë³„ë„ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰
2. **í•˜ë“œì›¨ì–´ ìµœì í™”**:
   - **SSD ì‚¬ìš©**: ë””ìŠ¤í¬ I/O ì„±ëŠ¥ í–¥ìƒ (PDF ì½ê¸°/ì“°ê¸°)
   - **ë©”ëª¨ë¦¬ ì¦ì„¤**: BGE-M3 ëª¨ë¸ ë¡œë”© ì†ë„ í–¥ìƒ
   - **GPU ì‚¬ìš©**: CUDA ì§€ì› ì‹œ ì„ë² ë”© ìƒì„± ê°€ì†í™”
3. **ë‹¤ì¤‘ ì²˜ë¦¬ ëŠ¥ë ¥**:
   - **ë™ì‹œ ì—…ë¡œë“œ**: ì—¬ëŸ¬ PDF íŒŒì¼ ë™ì‹œ ì²˜ë¦¬ ì§€ì›
   - **ì§„í–‰ë¥  ì¶”ì **: ì‹¤ì‹œê°„ ìƒíƒœ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ

### ğŸ¯ ì •í™•ë„ í–¥ìƒ
1. **ê³ í’ˆì§ˆ PDF**: ìŠ¤ìº” í’ˆì§ˆì´ ì¢‹ì€ ë¬¸ì„œ ì‚¬ìš©
2. **ì˜¬ë°”ë¥¸ ì–¸ì–´ ì„¤ì •**: Tesseract ì–¸ì–´ íŒ© í™•ì¸
3. **ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™**: LLaVA, LLM ì„œë¹„ìŠ¤ ì•ˆì •ì„± í™•ë³´

### ğŸ“Š ëª¨ë‹ˆí„°ë§ ì§€í‘œ (ë¹„ë™ê¸° ì²˜ë¦¬ ì¤‘ì‹¬)
- **ì—…ë¡œë“œ ì‘ë‹µ ì‹œê°„**: PDF ì—…ë¡œë“œ API ì‘ë‹µ ì‹œê°„ (ëª©í‘œ: < 1ì´ˆ)
- **ì²˜ë¦¬ ì™„ë£Œ ì‹œê°„**: ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ì „ì²´ ì†Œìš” ì‹œê°„
- **ì§„í–‰ë¥  ì •í™•ë„**: ì‹¤ì œ ì²˜ë¦¬ ë‹¨ê³„ì™€ ë³´ê³ ëœ ì§„í–‰ë¥ ì˜ ì¼ì¹˜ë„
- **ë™ì‹œ ì²˜ë¦¬ ëŠ¥ë ¥**: ë™ì‹œ ì²˜ë¦¬ ê°€ëŠ¥í•œ PDF ìˆ˜ëŸ‰
- **Job ìƒíƒœ ì •í™•ì„±**: ì²˜ë¦¬ ìƒíƒœ ì „í™˜ì˜ ì •í™•ì„± (uploaded â†’ processing â†’ completed)
- **ì„±ê³µë¥ **: ê° ì²˜ë¦¬ ë‹¨ê³„ë³„ ì„±ê³µë¥ 
- **ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**: CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ì‚¬ìš©ë¥ 
- **ì˜¤ë¥˜ìœ¨**: ì‹œê°„ëŒ€ë³„ ì˜¤ë¥˜ ë°œìƒ íŒ¨í„´

---

**RefServer API Testing Guide v0.1.7** - í™˜ê²½ ì ì‘í˜• í…ŒìŠ¤íŠ¸ + ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œìŠ¤í…œ í¬í•¨ ì™„ì „í•œ API í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ ê°€ì´ë“œ âœ…