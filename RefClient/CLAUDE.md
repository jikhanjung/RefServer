# 🖥️ RefClient - GUI 테스트 클라이언트 (v0.2.0)

## 📄 프로젝트 개요
RefClient는 RefServer의 모든 테스트 기능을 GUI로 제공하는 PyQt6 기반 클라이언트 애플리케이션입니다. 기존 tests/ 디렉토리의 CLI 테스트 스크립트들을 사용자 친화적인 GUI 환경으로 통합합니다.

## 🎯 핵심 기능
- **통합 테스트 인터페이스**: 모든 RefServer API 테스트를 GUI로 실행
- **실시간 테스트 모니터링**: 테스트 진행 상황 및 결과를 실시간으로 표시
- **테스트 결과 시각화**: 성공/실패 통계, 성능 지표, 상세 로그
- **배치 테스트 관리**: 여러 테스트를 순차적으로 실행
- **설정 관리**: 서버 URL, 인증 정보, 테스트 옵션 관리

## 📁 디렉토리 구조
```
RefClient/
├── gui/                    # GUI 애플리케이션
│   ├── main.py            # PyQt6 메인 애플리케이션
│   ├── widgets/           # 커스텀 위젯
│   │   ├── test_runner.py     # 테스트 실행 위젯
│   │   ├── log_viewer.py      # 로그 뷰어 위젯
│   │   ├── settings.py        # 설정 위젯
│   │   └── dashboard.py       # 대시보드 위젯
│   ├── models/            # 데이터 모델
│   │   ├── test_model.py      # 테스트 데이터 모델
│   │   └── config_model.py    # 설정 데이터 모델
│   ├── utils/             # 유틸리티
│   │   ├── test_wrapper.py    # 기존 테스트 스크립트 래퍼
│   │   └── config_manager.py  # 설정 관리
│   └── resources/         # 리소스 파일
│       ├── icons/             # 아이콘
│       └── styles/            # CSS 스타일
├── tests/                 # 기존 테스트 스크립트들 (변경 없음)
│   ├── test_api.py
│   ├── test_api_core.py
│   ├── test_admin_system.py
│   ├── test_backup_system.py
│   └── test_ocr_language_detection.py
└── requirements.txt       # GUI 의존성 추가
```

## 🧩 기존 테스트 스크립트 분석

### 1. test_ocr_language_detection.py (가장 단순)
- **기능**: OCR 언어 감지 하이브리드 시스템 테스트
- **테스트 케이스**: 5개 언어 (영어, 한국어, 일본어, 중국어, 프랑스어)
- **메서드**: 텍스트 기반, OCR 기반, LLaVA 기반, 하이브리드 감지
- **GUI 요소**: 언어별 테스트 버튼, 결과 테이블, 정확도 차트

### 2. test_api_core.py (핵심 API)
- **기능**: RefServer 핵심 API 테스트
- **테스트 항목**: PDF 업로드, 처리 상태 폴링, 메타데이터 추출, 임베딩, 레이아웃 분석
- **GUI 요소**: 파일 선택, 진행률 바, 테스트 결과 트리뷰

### 3. test_api.py (전체 API)
- **기능**: RefServer 모든 API 엔드포인트 테스트
- **테스트 항목**: 25개+ 엔드포인트, 비동기/동기 처리, 에러 핸들링
- **GUI 요소**: 테스트 선택 체크박스, 전체 실행 버튼, 상세 로그

### 4. test_admin_system.py (관리자 기능)
- **기능**: 관리자 인터페이스 및 권한 관리 테스트
- **테스트 항목**: 로그인, 대시보드, 백업 관리, 일관성 검증
- **GUI 요소**: 인증 정보 입력, 관리자 기능 테스트 패널

### 5. test_backup_system.py (백업 시스템)
- **기능**: v0.1.12 백업, 복구, 일관성 시스템 테스트
- **테스트 항목**: SQLite 백업, ChromaDB 백업, 통합 백업, 재해 복구
- **GUI 요소**: 백업 유형 선택, 복구 시뮬레이션, 상태 모니터링

## 🎨 GUI 설계 계획

### 메인 윈도우 레이아웃
```
┌─────────────────────────────────────────────────────┐
│ RefClient - RefServer GUI 테스트 클라이언트          │
├─────────────────────────────────────────────────────┤
│ [설정] [도움말]                          [연결 상태] │
├─────────────────────────────────────────────────────┤
│ ┌─ 테스트 카테고리 ─┐ ┌─ 실행 결과 ────────────────┐ │
│ │ □ 언어 감지 OCR    │ │ 실시간 로그 및 진행률      │ │
│ │ □ 핵심 API        │ │                           │ │
│ │ □ 전체 API        │ │ ┌─ 진행률 ──────────────┐  │ │
│ │ □ 관리자 시스템    │ │ │ ████████████░░░░ 75% │  │ │
│ │ □ 백업 시스템      │ │ └──────────────────────┘  │ │
│ │                   │ │                           │ │
│ │ [전체 실행]       │ │ ┌─ 테스트 결과 ─────────┐  │ │
│ │ [선택 실행]       │ │ │ ✅ 언어감지: 5/5 PASS │  │ │
│ │ [중지]           │ │ │ ✅ API: 15/18 PASS   │  │ │
│ └───────────────────┘ │ │ ❌ 백업: 2/5 FAIL    │  │ │
│                       │ └──────────────────────┘  │ │
├─────────────────────────────────────────────────────┤
│ ┌─ 상세 로그 ─────────────────────────────────────┐ │
│ │ [12:34:56] INFO: 테스트 시작...                 │ │
│ │ [12:34:57] PASS: Health Check - PASSED (200)   │ │
│ │ [12:34:58] FAIL: Backup - FAILED (500)         │ │
│ └─────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────┘
```

### 주요 위젯 구성
1. **TestCategoryWidget**: 테스트 카테고리 선택 및 옵션
2. **TestRunnerWidget**: 테스트 실행 및 진행률 표시
3. **LogViewerWidget**: 실시간 로그 및 결과 표시
4. **SettingsWidget**: 서버 설정 및 테스트 옵션
5. **DashboardWidget**: 전체 테스트 통계 및 성과 지표

## 🔧 기술 스택
- **GUI 프레임워크**: PyQt6
- **백그라운드 처리**: QThread, QWorker
- **데이터 모델**: QAbstractTableModel, QStandardItemModel
- **설정 관리**: QSettings (INI 파일)
- **로깅**: Python logging + QTextEdit
- **차트/그래프**: matplotlib + Qt backends

## 📋 구현 상태

### ✅ 완료된 기능
- [x] **프로젝트 구조 설정**: 완전한 디렉토리 구조 및 모듈 분리
- [x] **메인 윈도우**: PyQt6 기반 완전한 GUI 인터페이스
- [x] **설정 관리**: QSettings 기반 자동 저장/복원 시스템
- [x] **테스트 실행 엔진**: QThread 기반 백그라운드 테스트 실행
- [x] **실시간 로그 뷰어**: 레벨별 필터링 및 색상 구분
- [x] **진행률 표시**: 전체 진행률 및 현재 테스트 상태
- [x] **모든 테스트 스크립트 통합**: 5개 테스트 카테고리 완전 지원
- [x] **서버 연결 모니터링**: 실시간 상태 확인 및 표시
- [x] **테스트 결과 시각화**: 통계 테이블, 대시보드, 상세 로그
- [x] **배치 테스트 관리**: 다중 테스트 선택 및 순차 실행
- [x] **에러 핸들링**: 안전한 테스트 중지 및 예외 처리

### 🔧 핵심 컴포넌트
- **RefClientMainWindow**: 메인 애플리케이션 윈도우
- **TestRunnerWidget**: 백그라운드 테스트 실행 (멀티스레드)
- **LogViewerWidget**: 실시간 로그 스트리밍
- **SettingsWidget**: 서버 설정 다이얼로그
- **DashboardWidget**: 테스트 통계 대시보드
- **ConfigManager**: QSettings 기반 설정 관리

### 🚀 향후 개선 계획
- [ ] 테스트 결과 내보내기 (CSV, JSON)
- [ ] 테마 및 다크모드 지원
- [ ] 테스트 스케줄링 기능
- [ ] 성능 프로파일링 차트
- [ ] 자동 업데이트 확인

## 📊 기대 효과
1. **사용성 향상**: CLI 명령어 없이 직관적인 GUI로 테스트 실행
2. **시각적 피드백**: 실시간 진행률, 결과 차트, 성능 지표
3. **효율성 증대**: 배치 테스트, 자동화된 리포팅
4. **접근성 개선**: 비개발자도 쉽게 RefServer 테스트 가능
5. **디버깅 지원**: 상세 로그, 단계별 실행, 에러 추적

## 📝 주요 테스트 스크립트 특징

### RefServerAPITester (test_api.py)
- **25개+ API 엔드포인트** 종합 테스트
- **비동기 처리 API** 지원 (upload → job status polling)
- **환경 적응형 테스트** (GPU/CPU 모드 자동 감지)
- **상세한 로깅** 및 성공률 계산
- **에러 핸들링** 및 timeout 처리

### RefServerCoreAPITester (test_api_core.py)
- **핵심 PDF 처리** 파이프라인 테스트
- **실시간 진행률 추적** 및 상태 모니터링
- **벡터 검색 API** 테스트 (v0.1.10+)
- **배포 모드별 기능** 차별화 테스트

### RefServerAdminTester (test_admin_system.py)
- **JWT 기반 로그인** 및 권한 관리
- **백업 시스템** 관리 인터페이스 테스트
- **일관성 검증** 시스템 테스트
- **Superuser 전용 기능** 분리 테스트

### RefServerBackupTester (test_backup_system.py)
- **SQLite/ChromaDB 백업** 생성 및 검증
- **통합 백업** 시스템 테스트
- **재해 복구 준비도** 평가
- **백업 무결성 검증** 및 복구 시뮬레이션

### OCR Language Detection (test_ocr_language_detection.py)
- **5개 언어** 감지 정확도 테스트
- **하이브리드 감지 시스템** (텍스트 → LLaVA → Multi-OCR)
- **테스트 PDF 동적 생성** 및 정리
- **엣지 케이스** 처리 테스트

## 🛠️ 기술 구현 상세

### 테스트 래퍼 시스템
각 테스트 스크립트를 GUI에서 실행하기 위한 래퍼 클래스:
- **TestScriptWrapper**: 공통 인터페이스
- **백그라운드 실행**: QThread 기반 비동기 처리
- **신호/슬롯**: 실시간 로그 업데이트 및 진행률 표시
- **예외 처리**: 테스트 실패 시 GUI 안정성 보장

### 설정 관리
- **QSettings 기반**: 설정 자동 저장/복원
- **서버 연결 정보**: URL, 포트, 타임아웃
- **인증 정보**: 사용자명, 패스워드 (암호화 저장)
- **테스트 옵션**: 선택적 테스트 실행, 로그 레벨

### 로그 시스템
- **실시간 로그 스트리밍**: 테스트 실행 중 즉시 표시
- **로그 레벨 필터링**: DEBUG, INFO, WARNING, ERROR
- **로그 내보내기**: 텍스트 파일로 저장
- **색상 코딩**: 로그 레벨별 시각적 구분

현재 상태: **GUI 클라이언트 구현 완료** - PyQt6 기반 완전한 테스트 인터페이스 제공, 모든 RefServer 테스트 기능 GUI 통합