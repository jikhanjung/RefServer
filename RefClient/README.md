# RefClient - RefServer GUI 테스트 클라이언트

RefServer의 모든 테스트 기능을 GUI로 제공하는 PyQt6 기반 클라이언트 애플리케이션입니다.

## 🎯 주요 기능

### 🚀 GUI 테스트 환경
- **PyQt6 기반**: 직관적이고 반응성이 좋은 데스크톱 애플리케이션
- **통합 테스트 인터페이스**: 모든 RefServer API 테스트를 GUI로 실행
- **실시간 테스트 모니터링**: 테스트 진행 상황 및 결과를 실시간으로 표시
- **테스트 결과 시각화**: 성공/실패 통계, 성능 지표, 상세 로그
- **배치 테스트 관리**: 여러 테스트를 순차적으로 실행

### ⚙️ 고급 기능
- **서버 연결 상태 모니터링**: 실시간 RefServer 연결 상태 확인
- **설정 관리**: 서버 URL, 인증 정보, 테스트 옵션 자동 저장/복원
- **멀티 스레드 처리**: 백그라운드에서 테스트 실행, UI 응답성 유지
- **상세 로깅**: 레벨별 로그 필터링 및 색상 구분
- **테스트 중지/재시작**: 실행 중인 테스트 안전하게 중지 가능

## 📦 설치 및 실행

### 의존성 설치

```bash
# RefClient 디렉토리에서
pip install -r requirements.txt
```

### 실행

```bash
# RefClient 디렉토리에서 GUI 애플리케이션 시작
cd RefClient
python gui/main.py
```

**첫 실행 시:**
1. RefServer가 실행 중인지 확인 (http://localhost:8060)
2. 설정 메뉴에서 서버 URL 및 관리자 계정 정보 확인
3. "연결 테스트" 버튼으로 서버 연결 상태 확인

## 🧪 지원되는 테스트

### 🔍 1. 서버 연결성 (기존 언어감지 OCR 대체)
- **기본 연결성**: Health, Status, Stats 엔드포인트 테스트
- **배포 모드 감지**: GPU/CPU 모드 자동 인식
- **응답 시간 측정**: 성능 모니터링 및 타임아웃 테스트
- **Ollama 연결성**: GPU 모드에서만 실행 (CPU 모드에서 자동 건너뛰기)
- **404 처리**: 잘못된 엔드포인트 오류 처리 확인

### ⚡ 2. 핵심 API
- **PDF 처리**: 업로드 → 작업 상태 폴링 → 완료 확인 (GPU 모드만)
- **논문 관리**: 목록 조회, 상세 정보, 다운로드
- **검색 시스템**: 기본 검색, 쿼리 검색 테스트
- **배포 모드 적응**: CPU 모드에서는 Ollama 의존적 기능 제외

### 🌐 3. 전체 API
- **포괄적 테스트**: 모든 공개 API 엔드포인트 (25개+)
- **HTTP 상태 코드**: 200, 404, 401, 403, 405 등 적절한 응답 확인
- **환경 적응형**: GPU/CPU 배포 모드에 따른 기능 차등 테스트
- **에러 핸들링**: 클라이언트/서버 오류 상황 대응 테스트

### 👤 4. 관리자 시스템
- **인증 시스템**: 로그인, 로그아웃, 세션 관리
- **관리자 인터페이스**: 대시보드, 논문 목록 접근 테스트
- **권한 관리**: 인증 필요 페이지 접근 제어 확인
- **HTML/JSON 응답**: 다양한 응답 형식 처리

### 🛡️ 5. 백업 시스템
- **백업 관리**: 대시보드, 상태 조회, 이력 확인
- **일관성 검증**: 데이터베이스 일관성 체크 시스템
- **재해 복구**: 시스템 복구 준비도 평가
- **고급 기능**: v0.1.12+ 엔터프라이즈 백업 기능

## 🎨 GUI 구성

### 메인 윈도우
- **왼쪽 패널**: 테스트 카테고리 선택 및 실행 컨트롤
- **오른쪽 패널**: 실시간 결과 표시 및 로그 뷰어  
- **상단**: 서버 연결 상태, **배포 모드 표시** (GPU/CPU), 설정 버튼
- **하단**: 전체 진행률 및 현재 실행 중인 테스트 표시

### 탭 기반 인터페이스
1. **대시보드**: 전체 테스트 통계 및 성과 지표
2. **테스트 결과**: 개별 테스트 결과 테이블 (성공/실패, 소요시간, 메시지)
3. **상세 로그**: 실시간 로그 스트림, 레벨별 필터링

### 주요 컴포넌트
- **TestRunnerWidget**: 내부 테스트 모듈 실행 (QThread 기반, subprocess 제거)
- **LogViewerWidget**: 실시간 로그 표시 및 색상 구분
- **SettingsWidget**: 서버 설정 다이얼로그 (URL, 인증, 타임아웃)
- **DashboardWidget**: 테스트 통계 차트 및 요약 정보
- **배포 모드 감지**: GPU/CPU 환경 자동 인식 및 적응형 테스트

## ⚙️ 설정

### 서버 연결
- **서버 URL**: RefServer API 주소 (기본값: http://localhost:8060)
- **타임아웃**: 연결 타임아웃 설정 (5-300초)
- **연결 테스트**: 실시간 서버 상태 확인

### 인증 정보
- **관리자 계정**: 관리자 시스템 테스트용
- **기본 계정**: admin / admin123
- **비밀번호 암호화**: base64 인코딩으로 저장

### 로그 설정
- **로그 레벨**: DEBUG, INFO, WARNING, ERROR, PASS, FAIL
- **자동 저장**: 로그 파일 자동 저장 옵션
- **필터링**: 레벨별 로그 필터링 및 색상 구분

## 🔧 기술 스택

### 핵심 기술
- **GUI 프레임워크**: PyQt6 (데스크톱 애플리케이션)
- **테스트 실행**: 내부 Python 모듈 (subprocess 대신 직접 호출)
- **백그라운드 처리**: QThread, QObject 신호/슬롯 시스템
- **배포 모드 감지**: 자동 GPU/CPU 환경 인식

### 데이터 및 통신
- **설정 관리**: QSettings (자동 저장/복원)
- **로깅**: Python logging + 실시간 스트리밍
- **네트워킹**: requests (HTTP API 호출)
- **테스트 모듈**: BaseTest 기반 상속 구조

## 📁 프로젝트 구조

```
RefClient/
├── gui/                    # GUI 애플리케이션
│   ├── main.py            # PyQt6 메인 애플리케이션
│   ├── test_modules/      # 내부 테스트 모듈 (NEW!)
│   │   ├── base_test.py       # 기본 테스트 클래스 (배포 모드 감지)
│   │   ├── health_test.py     # 서버 연결성 테스트
│   │   ├── core_api_test.py   # 핵심 API 테스트
│   │   ├── full_api_test.py   # 전체 API 테스트
│   │   ├── admin_test.py      # 관리자 시스템 테스트
│   │   └── backup_test.py     # 백업 시스템 테스트
│   ├── widgets/           # 커스텀 위젯
│   │   ├── test_runner.py     # 테스트 실행 위젯 (내부 모듈 사용)
│   │   ├── log_viewer.py      # 로그 뷰어 위젯
│   │   ├── settings.py        # 설정 위젯
│   │   └── dashboard.py       # 대시보드 위젯
│   ├── utils/             # 유틸리티
│   │   └── config_manager.py  # 설정 관리 (배포 모드 지원)
│   └── resources/         # 리소스 파일
├── tests/                 # 참고용 기존 테스트 스크립트들
├── requirements.txt       # 의존성
├── CLAUDE.md             # 개발 문서
└── README.md             # 사용자 가이드
```

## 🚀 사용법

### 기본 사용 흐름
1. **RefServer 실행**: RefServer가 실행 중이어야 합니다 (포트 8060)
2. **RefClient 시작**: `cd RefClient && python gui/main.py` 실행
3. **연결 확인**: 상단의 "연결 상태"가 "연결됨"(녹색)인지 확인
4. **테스트 선택**: 왼쪽 패널에서 실행할 테스트 카테고리 체크
5. **테스트 실행**: "전체 실행" 또는 "선택 실행" 버튼 클릭
6. **결과 확인**: 오른쪽 패널의 탭들에서 실시간 결과 확인

### 상세 사용법

#### 테스트 카테고리 선택
- **서버 연결성**: 가장 빠름 (~30초), 기본 헬스체크 및 배포 모드 감지
- **핵심 API**: 중간 속도 (~2-5분), 배포 모드에 따른 적응형 테스트  
- **전체 API**: 빠른 속도 (~1-2분), 모든 엔드포인트 상태 코드 확인
- **관리자 시스템**: 로그인 필요, 관리 기능 및 인증 테스트
- **백업 시스템**: 고급 기능, 데이터 일관성 및 재해 복구 테스트

#### 실시간 모니터링
- **진행률 바**: 전체 테스트 진행률 표시
- **현재 테스트**: 현재 실행 중인 테스트 표시
- **상세 로그**: 실시간 로그 스트림 (INFO, WARNING, ERROR 등)
- **테스트 결과 테이블**: 각 테스트의 성공/실패 상태

#### 배포 모드별 동작
- **GPU 모드**: 모든 테스트 실행 (PDF 처리, Ollama 연결성 포함)
- **CPU 모드**: Ollama 의존적 테스트 자동 건너뛰기
- **모드 감지**: 상단에 "모드: GPU" 또는 "모드: CPU" 표시
- **적응형 테스트**: 환경에 따라 테스트 항목 자동 조정

#### 문제 해결
- **연결 실패**: RefServer 실행 상태 및 포트 8060 확인
- **모드 감지 실패**: RefServer /status API 응답 확인
- **관리자 테스트 실패**: 설정에서 admin 계정 정보 확인
- **테스트 중지**: "중지" 버튼으로 안전하게 테스트 중단

## 📊 기대 효과

### 사용성 개선
- **GUI 인터페이스**: CLI 명령어 없이 직관적인 마우스/키보드 조작
- **실시간 피드백**: 테스트 진행률, 성공/실패 즉시 확인
- **안전한 중지**: 테스트 실행 중 언제든 안전하게 중단 가능
- **접근성**: 비개발자도 쉽게 RefServer 테스트 수행

### 효율성 증대  
- **배치 테스트**: 여러 테스트 카테고리 순차 실행
- **자동화**: 설정 저장/복원, 연결 상태 자동 확인
- **환경 적응**: GPU/CPU 모드 자동 감지 및 적응형 테스트
- **시각적 결과**: 테이블, 통계, 로그로 한눈에 파악
- **시간 절약**: 불필요한 테스트 자동 건너뛰기

### 디버깅 지원
- **상세 로깅**: 각 테스트 단계별 상세 로그 제공
- **에러 추적**: 실패한 테스트의 구체적인 에러 메시지
- **성능 모니터링**: 각 테스트의 소요시간 측정 및 표시
- **결과 내보내기**: 테스트 결과를 파일로 저장 (향후 버전)

## 🔍 문제 해결

### 연결 실패
- RefServer가 실행 중인지 확인
- 서버 URL이 올바른지 확인
- 방화벽 설정 확인

### 테스트 실패
- 관리자 인증 정보 확인
- 서버 상태 및 로그 확인
- 네트워크 연결 상태 확인

### GUI 오류
- PyQt6 설치 상태 확인
- Python 버전 호환성 확인 (3.8+)
- 로그에서 상세 에러 메시지 확인

## 📝 라이센스

RefServer 프로젝트의 일부로 동일한 라이센스를 따릅니다.

## 🤝 기여

RefServer 메인 프로젝트에 기여해주세요: [RefServer Repository](../)